# Skill Manager V0.5 测试计划（AI Workbench 壳子改造）

## 1. 基本信息

- 版本：`V0.5`
- 对应 PRD：`/Users/wuhaoyang/Documents/trae_projects/skills/docs/prd/PRD-Skill-Manager-V0.5.md`
- 测试目标：验证“只改壳子、不改技能管理业务语义”是否成立。
- 执行方式：AI 自动执行为主，人工验收为辅。

## 2. 范围与边界

- 测试范围：
  - Workbench 壳子与导航切换
  - 技能管理模块挂载后核心行为
  - 用量监测占位页可达性与可回退性
- 不在本轮范围：
  - 真实用量统计数据准确性
  - 图表统计口径与告警规则
  - 业务重构（导入/推送规则改写）

## 3. 完成标准（Definition of Done）

自动化测试“完成”需要同时满足：

1. 计划内 `18/18` 用例全部通过。
2. 连续执行 2 轮均通过（无随机失败）。
3. `P0` 用例通过率 `100%`。
4. 无 `Blocker/Critical` 级缺陷遗留。

说明：满足以上条件表示“V0.5 自动化闭环完成”，不代表未来版本无需新增用例。

## 4. 用例清单（共 18 条）

### 4.1 单元测试（8 条）

| ID | 优先级 | 测试点 | 预期结果 |
|---|---|---|---|
| UT-01 | P1 | `WorkbenchLayout` 默认激活模块 | 默认 `activeModule=skills` 时高亮“技能管理” |
| UT-02 | P1 | 点击不同导航项 | 触发 `onModuleChange(moduleId)` |
| UT-03 | P2 | 点击已激活导航项 | 不重复触发切换回调 |
| UT-04 | P1 | `UsageMonitorModule` 渲染 | 正确渲染占位页根内容 |
| UT-05 | P0 | `dataStore.getConfig` 向后兼容 | 自动补齐 V0.5 需要字段，不抛异常 |
| UT-06 | P0 | `initPushTargetsAfterImport` 初始化策略 | 根据导入工具生成正确 `pushTargets` |
| UT-07 | P1 | `addCustomPath` 输入校验 | 非法路径/重复路径被拒绝并返回错误 |
| UT-08 | P1 | `setRepoPath` 路径变更 | 规范化路径，失败时返回失败结果 |

### 4.2 集成测试（6 条）

| ID | 优先级 | 测试点 | 预期结果 |
|---|---|---|---|
| IT-01 | P0 | 启动分流（有中央仓库数据） | `hasCentralSkills=true` 进入 `workbench` |
| IT-02 | P0 | 启动分流（无中央仓库数据） | `hasCentralSkills=false` 进入 `import` |
| IT-03 | P1 | 导入后页面迁移 | `import -> workbench` 切换成功 |
| IT-04 | P0 | 首次进入工作台初始化推送目标 | 触发初始化并清除首次标记 |
| IT-05 | P0 | 推送主链路 | 读取配置 -> 推送 -> 回写 `pushStatus` 成功 |
| IT-06 | P1 | 中央仓库缺失技能 | 返回错误信息，不导致应用崩溃 |

### 4.3 E2E 冒烟测试（4 条）

| ID | 优先级 | 测试点 | 预期结果 |
|---|---|---|---|
| E2E-01 | P0 | 默认进入 Workbench 壳子 | 首屏出现左侧导航和右侧内容区 |
| E2E-02 | P0 | 导航切到用量监测 | 右侧展示用量监测占位页 |
| E2E-03 | P0 | 导航切回技能管理 | 内容区正确回到技能管理页 |
| E2E-04 | P1 | 多次来回切换稳定性 | 无白屏/卡死，可持续切换 |

## 5. 执行顺序

1. 先跑单元测试（UT-01 ~ UT-08）。
2. 再跑集成测试（IT-01 ~ IT-06）。
3. 最后跑 E2E 冒烟（E2E-01 ~ E2E-04）。
4. 失败时进入 AI 修复循环（最多 3 轮）：`执行 -> 定位 -> 修复 -> 重跑`。

## 6. 结果产出

- 输出文件：
  - `TEST_REPORT.md`（本轮通过率、失败项、修复项、剩余风险）
- 最终结论：
  - `PASS`：满足第 3 节全部条件。
  - `FAIL`：任一条件不满足。

